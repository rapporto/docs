
Рассылка с идентификаторами
=========================================

При создании рассылки без идентификаторов необходимо учитывать :doc:`общие требования к файлам <ivr_ftp_file_require>`, а также следующие требования: 

* кодировка текстового файла с расширением .data: Windows-1251 или UTF-8;
* в файле между параметрами и списком номеров с зачитываемыми текстами должна быть пустая строка;
* в файле номера абонентов должны быть записаны в международном формате. Для российских сотовых сетей номер абонента состоит из 11 цифр и начинается с "7";
* максимальная длина зачитываемого текста: 1000 символов;
* максимальный размер файла с расширением .mp3: 2 Mb.


.. tabs::

    .. tab:: Пример файла

        .. code-block:: 
           :linenos:

            name: sendout20240915
            service_number: ВАШЕ_СЕРВИСНОЕ_ИМЯ
            auto_start: Y
            
            272344713;79031234567;;file_001.mp3
            435235262;79031234568;;file_002.mp3
            ...

    .. tab:: Формат файла

        .. code-block:: 
           :linenos:

            name: 
            service_number: 
            auto_start: 

            Идентификатор 1;номер 1;зачитываемый текст 1;файл_001.mp3
            Идентификатор 2;номер 2;зачитываемый текст 2;файл_002.mp3
            ...
            Идентификатор n;номер n;зачитываемый текст n;файл_n.mp3

        .. note::
   
            Если файл содержит одинаковые номера телефонов, обработан будет только первый, встречающийся в списке. Остальные номера будут отклонены системой. 



    .. tab:: Описание параметров

        .. note:: Обязательные параметры выделены в таблице **жирным** шрифтом.

        +-------------------------+----------------------------------------------------------------------------------------------------------+
        | Параметр                | Описание                                                                                                 |
        +=========================+==========================================================================================================+
        | **name**                | Название рассылки, должно быть уникальным.                                                               |
        +-------------------------+----------------------------------------------------------------------------------------------------------+
        | **service_number**      | Имя отправителя.                                                                                         |
        +-------------------------+----------------------------------------------------------------------------------------------------------+
        | date_start              | | Дата запуска рассылки в формате YYYY-MM-DD.                                                            |
        |                         | | Если дата старта не указана, то рассылка начнется в текущую дату.                                      | 
        +-------------------------+----------------------------------------------------------------------------------------------------------+
        | auto_start              | Автоматический старт рассылки.                                                                           |
        |                         | Возможные значения:                                                                                      |
        |                         |                                                                                                          |
        |                         | * Y - да;                                                                                                |
        |                         | * N - нет.                                                                                               |
        |                         |                                                                                                          |
        |                         | Использование данной функции оговаривается отдельно.                                                     |
        +-------------------------+----------------------------------------------------------------------------------------------------------+
        | time_begin              | Нижняя граница временного интервала, в котором будет осуществляться доставка в формате hh:mm.            |
        +-------------------------+----------------------------------------------------------------------------------------------------------+
        | time_end                | Верхняя граница временного интервала, в котором будет осуществляться доставка в формате hh:mm.           |
        +-------------------------+----------------------------------------------------------------------------------------------------------+
        | use_timediff            | Осуществление звонка с учётом часового пояса абонента.                                                   |
        |                         | Возможные значения:                                                                                      |
        |                         |                                                                                                          |
        |                         | * Y - да;                                                                                                |
        |                         | * N - нет.                                                                                               |
        +-------------------------+----------------------------------------------------------------------------------------------------------+
        | retry_count             | Количество попыток дозвона. По умолчанию: 1 попытка.                                                     |
        +-------------------------+----------------------------------------------------------------------------------------------------------+
        | retry_interval          | Период в минутах между попытками дозвона. По умолчанию: 1 минута.                                        |
        +-------------------------+----------------------------------------------------------------------------------------------------------+
        | order                   | Порядок воспроизведения звукового файла и зачитывания текста:                                            |
        |                         |                                                                                                          |
        |                         | * file_first — сначала файл;                                                                             |
        |                         | * text_first — сначала текст.                                                                            |
        |                         |                                                                                                          |
        |                         | По умолчанию: *text_first*.                                                                              |
        +-------------------------+----------------------------------------------------------------------------------------------------------+
        | voice_type              | Параметр определяет, на каком языке и каким голосом (женским или мужским) будет зачитан текст            |
        |                         | (если есть зачитываемый текст).                                                                          |
        |                         |                                                                                                          |
        |                         | Возможные значения:                                                                                      |
        |                         |                                                                                                          |
        |                         | * russian_male;                                                                                          |
        |                         | * russian_female;                                                                                        |
        |                         | * english_male;                                                                                          |
        |                         | * english_female.                                                                                        |
        |                         |                                                                                                          |
        |                         | По умолчанию: *russian_male*.                                                                            |
        +-------------------------+----------------------------------------------------------------------------------------------------------+
        | scenario_id             | Идентификатор одного из доступных сценариев воспроизведения голосового сообщения.                        |
        |                         |                                                                                                          |
        |                         | | По умолчанию: "Простой звонок" (простое воспроизведение голосового сообщения абонента без возможности  |
        |                         |   обработки нажатий клавиш абонентом).                                                                   |
        |                         | | Дополнительные сценарии необходимо согласовывать с персональным менеджером.                            |
        +-------------------------+----------------------------------------------------------------------------------------------------------+
        | priority                | Приоритет IVR-сообщения (от 1 до 100).                                                                   |
        +-------------------------+----------------------------------------------------------------------------------------------------------+
        | max_threads             | Количество потоков обзвона. По умолчанию: 5.                                                             |
        +-------------------------+----------------------------------------------------------------------------------------------------------+
        | week_sched              | | Расписание звонков. Параметр определяет, в какие дни недели будут осуществляться звонки.               |
        |                         | | Например, "1234567" — в любой день недели, "12" — в понедельник и вторник.                             |
        |                         |                                                                                                          |
        |                         | По умолчанию: в любой день недели.                                                                       |
        +-------------------------+----------------------------------------------------------------------------------------------------------+