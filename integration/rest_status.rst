Сервис получения статусов доставки
==================================

Метод передачи данных – POST.

Сервис-провайдер отправляет Партнёру отчёт о доставке сообщений, передавая его на настроенный URL для передачи статусов доставки. URL для
передачи статусов задается в настройках интеграции при подключении сервиса, так же он может передаваться в параметре *notifyUrl.* Переданный в параметре адрес считается приоритетным, а в случае, если
параметр не передан или передан некорректный адрес, то отчет о доставке сообщений передается на заданный при настройке соединения.

Статусы доставки сообщений
--------------------------

+---+-------------------------------+-------------------------------+
| 0 | Отправлено (SEND)             | Отправлено в сторону          |
|   |                               | Оператора, финальный статус   |
|   |                               | пока не известен.             |
+---+-------------------------------+-------------------------------+
| 2 | Доставлено (DELIVERED)        | Доставлено оператору, после   |
|   |                               | доставки возможно ожидание    |
|   |                               | статуса о прочтении абонентом |
|   |                               | (для сообщения типа           |
|   |                               | FlashingCall является         |
|   |                               | финальным статусом).          |
+---+-------------------------------+-------------------------------+
| 5 | Не доставлено (UNDELIVERED,   | Отклонено оператором/не       |
|   | REJECTED)                     | доставлено на оператора.      |
|   |                               | Информация о причине          |
|   |                               | недоставки указана в поле     |
|   |                               | параметров доставки           |
|   |                               | errorCode. Финальный статус,  |
|   |                               | далее других статусов не      |
|   |                               | ожидается.                    |
+---+-------------------------------+-------------------------------+
| 9 | Прочитано (READ)              | Статус о прочтении сообщения  |
|   |                               | абонентом (все сообщения,     |
|   |                               | кроме FlashingCall, SMS).     |
|   |                               | Финальный статус, далее       |
|   |                               | других статусов не ожидается. |
+---+-------------------------------+-------------------------------+

Для SMS-сообщений, отправленных абонентам оператора Мегафон, с
01.03.2023 прекращается передача статусов "Доставлено" и "Не
доставлено".

Параметры отчета о доставке сообщений
-------------------------------------

+-------------+---------+--------------------------------------------+
| id          | string  | Уникальный идентификатор на стороне        |
|             |         | Партнёра. Если Партнёр не передал, то      |
|             |         | значение отсутствует.                      |
+-------------+---------+--------------------------------------------+
| mtNum       | string  | Идентификатор цепочки отправки,            |
|             |         | присваиваемый платформой                   |
|             |         | Сервис-провайдера.                         |
+-------------+---------+--------------------------------------------+
| status      | integer | Статус доставки. Возвращает следующие      |
|             |         | значения:                                  |
|             |         |                                            |
|             |         | -  0 - отправлено в сторону Оператора,     |
|             |         |       финальный статус пока не известен;   |
|             |         |                                            |
|             |         | -  2 - доставлено;                         |
|             |         |                                            |
|             |         | -  5 - не доставлено. Информация о причине |
|             |         |       недоставки указана в поле errorCode; |
|             |         |                                            |
|             |         | -  9 – прочитано (кроме FlashingCall,      |
|             |         |       SMS).                                |
+-------------+---------+--------------------------------------------+
| type        | string  | Тип сообщения: SMS, VIBER, VK, PUSH,       |
|             |         | WHATSAPP, FLASHINGCALL.                    |
+-------------+---------+--------------------------------------------+
| doneDate    | date    | Дата/время доставки. Если не доставлено,   |
|             |         | то пусто.                                  |
+-------------+---------+--------------------------------------------+
| submitDate  | date    | Дата/время отправки сообщения.             |
+-------------+---------+--------------------------------------------+
| destAddr    | string  | Номер абонента.                            |
+-------------+---------+--------------------------------------------+
| sourceAddr  | string  | Сервисный номер, с которого была           |
|             |         | осуществлена отправка сообщения.           |
+-------------+---------+--------------------------------------------+
| text        | string  | Текст сообщения.                           |
+-------------+---------+--------------------------------------------+
| partCount   | string  | Количество частей сообщения.               |
+-------------+---------+--------------------------------------------+
| errorCode   | string  | Код ошибки.                                |
|             |         |                                            |
|             |         | Параметр errorCode при успешном выполнении |
|             |         | отправки равен 0. При status = 5           |
|             |         | возвращает код ошибки.                     |
+-------------+---------+--------------------------------------------+
| mccMnc      | string  | Mcc и Mnc коды. Cостоит из mcc-кода, как   |
|             |         | правило, состоящего из 3 цифр, и mnc-кода  |
|             |         | из 2 цифр.                                 |
+-------------+---------+--------------------------------------------+
| trafficType | integer | Тип трафика. Возвращает тип трафика:       |
|             |         |                                            |
|             |         | -  0 – рекламный;                          |
|             |         |                                            |
|             |         | -  1 – транзакционный;                     |
|             |         |                                            |
|             |         | -  2 – сервисный;                          |
|             |         |                                            |
|             |         | -  5 – информационный;                     |
|             |         |                                            |
|             |         | -  6 – авторизационный.                    |
+-------------+---------+--------------------------------------------+

Пример отчёта о доставке:

.. code-block:: json

    {
      "id":"8770599",
      "mtNum":"107930572",
      "status":2,
      "type":"SMS",
      "doneDate":"2019-05-05T10:20:35+0300",
      "submitDate":"2019-05-05T10:19:55+0300",
      "sourceAddr":"SOURCE",
      "destAddr": "72101234567",
      "text":"message_text",
      "partCount":"001",
      "errorCode":"0",
      "mccMnc":"25012",
      "trafficType":0
    }

